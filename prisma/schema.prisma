generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ReviewTargetType {
  bank
  mfo
  license
  site
}

enum Role {
  USER
  ADMIN
}

model User {
  id           Int      @id @default(autoincrement())
  email        String   @unique
  passwordHash String
  firstName    String?
  lastName     String?
  role         Role     @default(USER)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

// –î–æ–±–∞–≤–ª—è–µ–º –º–æ–¥–µ–ª—å —ç–∫—Å–ø–µ—Ä—Ç–æ–≤
model Expert {
  id           Int     @id @default(autoincrement())
  name         String
  nameUk       String?
  slug         String  @unique
  avatar       String?
  bio          String?
  bioUk        String?
  position     String
  positionUk   String?
  experience   String
  experienceUk String?
  isActive     Boolean @default(true)
  color        String? // –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∏—è –æ—Ç–≤–µ—Ç–æ–≤
  totalAnswers Int     @default(0)

  expertise      String[]
  expertiseUk    String[]
  achievements   String[]
  achievementsUk String[]

  telegram String?
  linkedin String?
  twitter  String?
  email    String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // –°–≤—è–∑–∏ —Å –æ—Ç–≤–µ—Ç–∞–º–∏
  questionAnswers QuestionAnswer[]
  reviewAnswers   ReviewAnswer[]
}

model MfoFaq {
  id        Int      @id @default(autoincrement())
  mfoId     Int
  mfo       Mfo      @relation(fields: [mfoId], references: [id], onDelete: Cascade)

  questionRu String
  questionUk String

  answerRu   String
  answerUk   String

  order      Int      @default(0) // —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ

  isActive   Boolean  @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Mfo {
  id            Int     @id @default(autoincrement())
  name          String
  UtmLink       String?
  rating        Float
  logo          String
  licenseNumber String?
  isActive      Boolean @default(true)
  slug          String  @unique
  reviews Int?
  minAmount    Int
  maxAmount    Int
  minTerm      Int
  maxTerm      Int
  rateMin      Float
  rateMax      Float
  approvalRate Int
  decisionTime String

  // –£—Å–ª–æ–≤–∏—è
  isFirstLoanZero    Boolean @default(false)
  isInstantApproval  Boolean @default(false)
  isNoIncomeProof    Boolean @default(false)
  is24Support        Boolean @default(false)
  isSafeTransactions Boolean @default(false)
  isFlexibleTerms    Boolean @default(false)


  // üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  loansIssued       Int?    // –í–∏–¥–∞–Ω–æ –ø–æ–∑–∏–∫
  satisfiedClients  Int?    // –ó–∞–¥–æ–≤–æ–ª–µ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∏
  // –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
  ageFrom     Int
  ageTo       Int
  citizenship String @default("–£–∫—Ä")
  documents   String @default("–ü–∞—Å–ø–æ—Ä—Ç –£–∫—Ä")
  
  nbuCharacteristicsLink String? // –°—Å—ã–ª–∫–∞ –Ω–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ù–ë–£
  nbuWarningLink         String? // –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ù–ë–£
  // –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
  description      String?
   descriptionUk    String?  // –û–ø–∏—Å —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é
  phone            String?
  website          String?
  workTimeWeekdays String?
  workTimeWeekend  String?
  workTimeOnline   String?

  // –ù–æ–≤—ã–µ –ø–æ–ª—è
  dailyRate    Float? // —Å—Ç–∞–≤–∫–∞ –≤ –¥–µ–Ω—å (%)
  commission   Float? // –∫–æ–º–∏—Å—Å–∏—è (% –∏–ª–∏ —Å—É–º–º–∞)
  collateral   String? // –∑–∞–ª–æ–≥ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
  decisionType String? // —Ä–µ—à–µ–Ω–∏–µ –ø–æ –∑–∞–π–º—É (–∞–≤—Ç–æ/—Ä—É—á–Ω–æ–µ)
  application  String? // –ø–æ–¥–∞—á–∞ –∑–∞—è–≤–∫–∏ (–æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // –°–≤—è–∑–∏
    faqs                MfoFaq[]   // üëà –ß–ê–°–¢–´–ï –í–û–ü–†–û–°–´

  License            License[]
  mfoSatelliteLinks  MfoSatelliteMfo[]
  MfoSatelliteKeyMfo MfoSatelliteKeyMfo[]
  promoCodes         PromoCode[]
}

model PromoCode {
  id          Int       @id @default(autoincrement())
  code        String
  discountUk  String?
  discount    String
  conditionUk String?
  condition   String?
  validTill   DateTime?
  mfo         Mfo       @relation(fields: [mfoId], references: [id])
  mfoId       Int
}

model License {
  id        Int      @id @default(autoincrement())
  number    String
  issuedAt  DateTime
  validTill DateTime
  mfoId     Int
  mfo       Mfo      @relation(fields: [mfoId], references: [id])
}

model Question {
  id           Int              @id @default(autoincrement())
  slug         String 
  name         String? // –î–µ–ª–∞–µ–º –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º
  email        String? // –î–µ–ª–∞–µ–º –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º
  subject      String
  category     String
  textOriginal String
  textUk       String?
  textRu       String?
  isModerated  Boolean          @default(false)
  createdAt    DateTime         @default(now())
  targetType   ReviewTargetType
  targetId     Int

  answers QuestionAnswer[]
}

model QuestionAnswer {
  id           Int     @id @default(autoincrement())
  questionId   Int
  textOriginal String
  textUk       String?
  textRu       String?
  isModerated  Boolean @default(false)

  // –ü–æ–ª—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∞
  authorName  String? // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  authorEmail String? // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  expertId    Int? // –î–ª—è —ç–∫—Å–ø–µ—Ä—Ç–æ–≤

  createdAt DateTime @default(now())

  question Question @relation(fields: [questionId], references: [id], onDelete: Cascade)
  expert   Expert?  @relation(fields: [expertId], references: [id])
}

model Review {
  id           Int              @id @default(autoincrement())
  rating       Int
  textOriginal String
  textUk       String?
  textRu       String?
  isModerated  Boolean          @default(false)
  createdAt    DateTime         @default(now())
  targetType   ReviewTargetType
  targetId     Int
  authorName   String? // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  authorEmail  String? // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  answers      ReviewAnswer[]
}

// –î–æ–±–∞–≤–ª—è–µ–º –º–æ–¥–µ–ª—å –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Ç–∑—ã–≤—ã
model ReviewAnswer {
  id           Int     @id @default(autoincrement())
  reviewId     Int
  textOriginal String
  textUk       String?
  textRu       String?
  isModerated  Boolean @default(false)

  // –ü–æ–ª—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∞
  authorName  String? // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  authorEmail String? // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  expertId    Int? // –î–ª—è —ç–∫—Å–ø–µ—Ä—Ç–æ–≤

  createdAt DateTime @default(now())

  review Review  @relation(fields: [reviewId], references: [id])
  expert Expert? @relation(fields: [expertId], references: [id])
}

// News
model NewsCategory {
  id     Int    @id @default(autoincrement())
  name   String
  nameUk String
  slug   String @unique

  icon String?

    // üîç SEO –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  metaTitleRu       String?
  metaTitleUk       String?
  metaDescriptionRu String?
  metaDescriptionUk String?
  metaKeywordsRu    String?
  metaKeywordsUk    String?
  news News[]
}

model Author {
  id           Int      @id @default(autoincrement())
  name         String
  nameUk       String?
  slug         String   @unique
  avatar       String
  bio          String?
  bioUk        String?
  position     String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  positionUk   String?
  experience   String
  experienceUk String?
  followers    Int      @default(0)
  color        String?
  totalViews   Int      @default(0)
  totalPosts   Int      @default(0)

  expertise      String[]
  expertiseUk    String[]
  achievements   String[]
  achievementsUk String[]
  metaTitleRu       String?
  metaTitleUk       String?
  metaDescriptionRu String?
  metaDescriptionUk String?
    metaKeywordsRu    String?
  metaKeywordsUk    String?
  telegram String?
  linkedin String?
  twitter  String?
  email    String?

  articles News[]
}

model NewsLike {
  id        Int      @id @default(autoincrement())
  newsId    Int
  news      News     @relation(fields: [newsId], references: [id])
  createdAt DateTime @default(now())

  ipHash      String?
  fingerprint String?
  cookieId    String?
}

model News {
  id             Int      @id @default(autoincrement())
  title          String
  titleUk        String
  slug           String   @unique
  slugUk         String   @unique
  body           String
  bodyUk         String
  published      Boolean  @default(false)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  views          Int      @default(0)
  readingMinutes Int?
  image          String?
  authorId       Int
  author         Author   @relation(fields: [authorId], references: [id])

  newsCategoryId Int?


   // üîç SEO –ú–ï–¢–ê-–¢–ï–ì–ò (–î–û–ë–ê–í–ò–¢–¨)
  metaTitleRu       String?
  metaTitleUk       String?
  metaDescriptionRu String?
  metaDescriptionUk String?
  metaKeywordsRu    String?
  metaKeywordsUk    String?
  
  // Open Graph –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
  ogImageRu         String?
  ogImageUk         String?
  NewsCategory   NewsCategory? @relation(fields: [newsCategoryId], references: [id])

  NewsLike NewsLike[]
}

model FaqCategory {
  id        Int           @id @default(autoincrement())
  name      String
  nameUk    String?
  nameRu    String?
  order     Int           @default(0)
  icon      String?
  questions FaqQuestion[]
}

model FaqQuestion {
  id          Int         @id @default(autoincrement())
  questionUk  String?
  questionRu  String?
  answerUk    String?
  answerRu    String?
  order       Int         @default(0)
  isPublished Boolean     @default(false)
  categoryId  Int
  category    FaqCategory @relation(fields: [categoryId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model MfoSatelliteKey {
  id     Int    @id @default(autoincrement())
  keyUk  String
  keyRu  String
  slugUk String @unique
  slugRu String @unique

  metaTitleUk   String
  metaTitleRu   String
  metaDescUk    String
  metaDescRu    String
  titleUk       String
  titleRu       String
  descriptionUk String
  descriptionRu String
  seoContentUk  String @default("") @db.Text
  seoContentRu  String @default("") @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  satellites MfoSatellite[]

  mfoLinks MfoSatelliteKeyMfo[]
}

model MfoSatelliteKeyMfo {
  id    Int @id @default(autoincrement())
  keyId Int
  mfoId Int

  key MfoSatelliteKey @relation(fields: [keyId], references: [id])
  mfo Mfo             @relation(fields: [mfoId], references: [id])

  @@unique([keyId, mfoId])
}

model MfoSatellite {
  id Int @id @default(autoincrement())

  keyId Int
  key   MfoSatelliteKey @relation(fields: [keyId], references: [id])

  metaTitleUk   String
  metaTitleRu   String
  metaDescUk    String
  metaDescRu    String
  titleUk       String
  titleRu       String
  descriptionUk String
  descriptionRu String

  seoContentUk String @default("") @db.Text
  seoContentRu String @default("") @db.Text
  slugUk       String @unique
  slugRu       String @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  mfoLinks MfoSatelliteMfo[]
}

model MfoSatelliteMfo {
  id          Int @id @default(autoincrement())
  satelliteId Int
  mfoId       Int

  satellite MfoSatellite @relation(fields: [satelliteId], references: [id])
  mfo       Mfo          @relation(fields: [mfoId], references: [id])

  @@unique([satelliteId, mfoId])
}
